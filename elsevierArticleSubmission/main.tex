%&pdflatex
\documentclass[review]{elsarticle}
%\usepackage[utf8]{inputenc}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{courier}
\usepackage{graphicx}
% \usepackage{picins}
\usepackage{epstopdf}


\usepackage[nomarkers]{endfloat}

\newcommand{\listoflstlistings}{\lstlistoflistings}
\DeclareDelayedFloat{lstlisting}[flol]{\textbf{List of Listings}}

\lstset{tabsize=2,language=C++,basicstyle=\footnotesize\tt,keywordstyle=\color{blue}\bfseries}

\journal{Powder Technology}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frontmatter}

\title{Identification of DEM Simulation Parameters by Artificial Neural Networks
and Bulk Experiments}

\author[jku]{L.~Benvenuti\corref{cor1}}
%\ead{Tel. +43 73224686483}
\ead{luca.benvenuti@jku.at}

\author[dcs]{C.~Kloss}
%\ead{christoph.kloss@dcs-computing.com}

\author[jku]{S.~Pirker}
%\ead{stefan.pirker@jku.at}

\cortext[cor1]{Corresponding author}

\address[jku]{Johannes Kepler University Linz, Department on Particulate Flow
Modelling, Altenbergerstrasse 69, 4040, Linz, Austria}

\address[dcs]{DCS Computing GmbH, Altenbergerstr. 66a - Science Park, 4040 Linz,
Austria}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
In Discrete Element Method ($DEM$) simulations, particle-particle contact laws
determine the macroscopic simulation results. Particle-based contact laws, in
turn, commonly rely on semi-empirical parameters which are difficult to obtain
by direct microscopic measurements.
In this study, we present a method for the identification of
$DEM$ simulation parameters 
that uses artificial neural networks to link
macroscopic experimental results to
microscopic numerical parameters.
In the first step, a series
of $DEM$ simulations with varying simulation parameters is used to train a
feed-forward artificial neural network by backward-propagation reinforcement. 
In the second step, this artificial neural network is used to predict the
macroscopic ensemble behaviour in relation to additional sets of particle-based
simulation parameters.
Thus, a comprehensive database is obtained
which links particle-based simulation parameters to specific macroscopic
bulk behaviours of the ensemble.
The trained artificial neural network is able to predict the behaviours of
additional sets of input parameters accurately and highly efficiently.
Furthermore, this method can be used generically to
identify $DEM$ material parameters.
For each set of calibration experiments, the neural network 
needs to be trained only once.
After the training, the neural network provides a generic link between the macroscopic 
experimental results and the microscopic $DEM$ simulation parameters.
Based on these experiments, the $DEM$ simulation parameters of any given
non-cohesive granular material can be identified.

\end{abstract}

\begin{keyword}
Discrete Element Method ($DEM$) Simulations \sep Parameter Identification \sep Artificial Neural Networks
\end{keyword}
\end{frontmatter}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%************************************************
\section{Highlights}
\label{sec:highlights}
%************************************************
\begin{itemize}
  \item{We trained an Artificial Neural Network by DEM simulations with varying
  parameters}
  \item{The Artificial Neural Network then predicts granular bulk behaviour}
  \item{By comparison with bulk experiments, DEM simulation parameters are
  identified}
  \item{This DEM parameter identification can be applied to different bulk
  behaviours}
  \item{This DEM parameter identification can be applied to different granular
  materials}
\end{itemize}
%************************************************

%************************************************
\section{Introduction}
\label{sec:introduction}
%************************************************

Particles in various forms - ranging from raw materials to food grains and pharmaceutical powders - 
play a major role in a variety of industries. 
Discrete Element Methods ($DEMs$) are widely used to simulate
particle behaviour in these granular processes (Cleary and Sawley \cite{RefWorks:130}).\\
In their original formulation of $DEM$, Cundall and Strack \cite{RefWorks:172} allowed two 
particles to slightly overlap upon contact, and consequently they proposed
repulsive forces in relation to this overlap distance.
Their fundamental modelling concept has since been widely accepted in the
literature and their soft-sphere contact law has been developed further by
numerous researchers (Vu-Quoc and Zhang \cite{RefWorks:148} and Di Renzo and Di Maio \cite{RefWorks:145}). 
With increasing computational resources, $DEM$ simulations have become very
popular giving rise to the development of commercial (e.g., $PFC3D$, used by
Wensrich and Katterfeld \cite{RefWorks:87}) and open-source software (e.g.,
$LIGGGHTS$, Kloss et al. \cite{RefWorks:136}, Aigner et al. \cite{RefWorks:139}).
Soft-sphere $DEM$ simulations of thousands of particles have been proven to 
faithfully model particle bulk behaviour (Hohner et al. \cite{RefWorks:86}). \\
In these macroscopic $DEM$ simulations, the contact law kernel between a 
pair of particles determines the global bulk behaviour of the granular material (Ai et al. \cite{RefWorks:131}). 
As a consequence, defining a correct contact law is of crucial importance for the predictive 
capability of $DEM$ simulations. 
Since $DEM$ contact laws are based 
on a set of semi-empirical parameters, correct contact law 
parameters must be defined for a given granular material
or $DEM$ simulations will fail (Combarros et al. \cite{RefWorks:177}). \\
Identifying $DEM$ contact law parameters is not a trivial task. 
Due to the huge number of particles in a granular material, it
may be impractical to identify valid parameter sets by performing bilateral 
particle collision experiments. 
Furthermore, some contact law parameters such as the coefficient of rolling
friction are purely empirical and cannot be determined by direct 
particle-to-particle measurements (Wensrich and Katterfeld \cite{RefWorks:87}).
Therefore, $DEM$ contact law parameters (Table \ref{tab:08DEMparameters}) are
commonly determined by comparing the macroscopic outcome of large-scale $DEM$
simulations with bulk experiments (Alenzi et al. \cite{RefWorks:91}). 
If $DEM$ simulation results disagree with bulk measurements, the set of contact
law parameters must be adjusted until reasonable agreement is achieved.\\
However, this purely forward methodology of parameter identification is limited by 
the multi-dimensionality of the parameter space and the associated computational costs of the required 
$DEM$ test simulations. 
Moreover, one parameter set which is valid for one bulk behaviour (e.g., angle
of repose) might fail for another (e.g., shear tester). \\
There are yet ways to determine contact parameters directly by measuring
material properties or by performing particle based experiments, see e.g. Combarros et al. \cite{RefWorks:177}, 
Paulick et al. \cite{RefWorks:181}, and Lommen et al. \cite{RefWorks:186}. 
Luding and Vidyapati \cite{RefWorks:140, RefWorks:190}
are two of the most prominent examples of parameters identification by
theoretical analysis. However, they focused on glass spheres, while
non-sphericity was one of the fields we wanted to investigate. 
Further, it is related to all the microscopic parameters we analysed. 
Also the procedure of Combarros et al. \cite{RefWorks:177}, although on
industrial samples (aluminium oxide), still had mostly spherical particles. 
In addition, these methodologies are laborious, 
since they have to be performed for every new granular material prior to a $DEM$
simulations. 
Especially for the already cited rolling friction parameter, it is arduous to
link the rolling friction parameter to the non-sphericity of the particle. Clearly, there is a
need for an efficient method for identifying $DEM$ contact law parameters, given
a specific particle behaviour.
In our study, we harnessed Artificial Neural Networks ($ANNs$) in order to
reduce the number of $DEM$ test simulations required. 
$ANNs$ have proven to be a versatile tool in analysing complex, non-linear
systems of multi-dimensional input streams (Vaferi et al. \cite{RefWorks:150}, Witten et
al. \cite{RefWorks:174} and Haykin \cite{RefWorks:158}).
In our case, we fed an $ANN$ with $DEM$ contact law parameters as input
and compared the output with the bulk behaviour 
predicted by a corresponding $DEM$ simulation. 
The difference between $ANN$ prediction and $DEM$ prediction is used to train our 
specific $ANN$ with a backward-propagation algorithm (described further below). 
After a training phase comprising a limited number of $DEM$ test simulations,
the $ANN$ can then be used as a stand-alone prediction tool for the bulk behaviour of a 
granular material in relation to $DEM$ contact law parameters. \\
In this study, we applied this parameter identification method to two different
granular bulk behaviours, namely the angle of repose ($AoR$) test and the
Schulze shear cell ($SSC$) test.
In both cases, we first trained a specific $ANN$ using a number of $DEM$ test
simulations before we identified valid sets of $DEM$ contact law parameters by
comparing the stand-alone $ANN$ predictions with corresponding bulk experiments. 
For both cases we obtained valid sets of contact law parameters, 
which we then compared to formulate a reliable contact law for a given
granular material.
We further show that the same $ANN$ can be used to characterize different granular materials, 
which have the same particle behaviour and can modelled with the same contact
law. \\
In the next section we define some prerequisites including $DEM$ contact law
definitions, a general description of the $ANN$ functionality, and the proposed
method of $DEM$ contact law parameter identification.
We then describe how it is applied to characterize the $DEM$ contact law
parameters of sinter fines.
%************************************************
%\input{08DEMparameters}
\begin{table}[h]
\centering
\begin{tabular}{l}
\hline 
     Particle radius $R$ (m)   \\ [5pt]

	Size distribution (-) \\ [5pt]

    Young's modulus $E$ (Pa)  \\ [5pt]

    Poisson's ratio $\nu$ (-) \\ 
     Time step $\Delta t$ (-) \\ [5pt]
        \hline
     Coefficient of sliding friction $\mu_s$ (-)\\  [5pt]
    Coefficient of rolling friction $\mu_r$ (-) \\ [5pt]
    Coefficient of restitution $COR$ (-)   \\ [5pt]
     Particle density $\rho_p = \frac{mass ~ of ~ one ~ particle}{volume ~ of ~
     one ~ particle}$ ($kg/m^3$)  \\ [5pt] Geometry factor $dCylDp$ (-)  \\
     [5pt]
   
\hline
\end{tabular}
\caption[DEM parameters]{DEM parameters. The upper parameters were
identical in all simulations. The lower parameters were constant in each
simulation, but were varied between simulations.}
\label{tab:08DEMparameters}
\end{table}
%************************************************

\section{DEM Parameter Identification}
\label{sec:methodology}

Fig. \ref{fig:19methodology} illustrates the methodology used.

%************************************************
\begin{figure}[!htb] 
\centering 
\includegraphics[width=.96\textwidth]{19methodology} 
\caption[Method]{Method. 
In the training phase (dashed lines)
$DEM$ simulations are performed
with random initial input parameters.
The behaviours obtained are used to train the
Artificial Neural Networks ($ANNs$) in a loop that continues until the
difference between the outputs of each $ANN$ and its simulations is below the
limit ($\Delta$) (see Section \ref{subsec:ann}).
In the parameters identification phase (solid
lines) we identify valid input parameters by comparing (\textbf{=}) $ANNs$ and
experimental behaviours.
Further explanations can be found in Section \ref{sec:methodology}.
}
\label{fig:19methodology} 
\end{figure}

%************************************************
\subsection{Applicability and scope}
\label{subsec:applicability}

%************************************************
\begin{figure}[!htb] 
\centering 
\includegraphics[width=.96\textwidth]{104material} 
\caption[Sinter ore fine]{Sinter ore fine analysed.}
\label{fig:104material} 
\end{figure}

%************************************************

The material used for this work was sinter fine, see Fig.
\ref{fig:104material}. Its particles had a mean radius of 0.73 mm and were
cohesionless, see Section \ref{subsec:macroscopicexperimentsparameteridentification}.
Their amounts of open and closed pores are not negligible (see Yang
\cite{RefWorks:191}), and thus the use of an Archimedean procedure to
determine the correct particle density by direct measurement
was not applicable.
Possibly, a tomography for each particle would lead to the particle density,
but this analysis was infeasible: 
the necessary time for the the amount of material
analysed was unreasonable. 
Further, a three-dimensional scan of each particle would have surely physically
identified our particles, and made us able to confront them with other studies. 
The high shape dispersity made also this analysis impossible. 
We followed a different procedure, see Section
\ref{subsec:macroscopicexperimentsparameteridentification}.\\
To avoid the macroscopic plastic deformations analysed by Harthong et al. \cite{RefWorks:183} 
we checked for each simulation for its total duration that the packing density was 
lower than a defined limit. 
This threshold (0.671) was given by the packing density of the close random packing with the 
same size distribution, as suggested and with the software provided by Baranau, Tallarek 
et al. \cite{RefWorks:182, RefWorks:185}.
The experimental characterization was performed at environmental temperature and thus 
temperature was not considered in the numerical simulations. Chemical reactions and aging 
were also not part of the scope of this work.
Further, due to the limited number of experiments realized, a restricted number
of flow regimes were tested, and only one size distribution was considered. 
The authors are confident that these two limitations have not compromised the validity of the method. 
Rather, further investigations on these two aspects could again demonstrate its effectiveness. 
Notably, we chose an elastic model to picture the particle behaviour. If we try
to identify parameters for an elastic contact model in a system of non-elastic particles, this $ANN$ approach will fail. 
So choosing appropriate contact models is an essential pre-requisite for contact 
parameter identification by means of $ANN$. 
Moreover, $ANNs$ can give indications about the correctness of the chosen model, 
see Section \ref{subsec:experimentsparameteridentification}.
%************************************************
\subsection{Discrete element method}
\label{subsec:dem}

For each particle i inside the domain, a Discrete Element Method ($DEM$) code follows the trajectory and 
calculates the force that particle i exerts on particle j, according to the imposed contact law. 
We decided to utilize a single contact law, equal for each particle, in all the simulations performed. 
Di Renzo and Di Maio \cite{RefWorks:145} suggested using the elastic non-linear Hertzian 
model without cohesion for the particle-particle and particle-wall contacts.
$LIGGGHTS$, the simulation toolbox we used, meets all the requirements of
modelling a shear tester, see Kloss et al. \cite{RefWorks:136}, Aigner et al. \cite{RefWorks:139}, 
and Benvenuti et al. \cite{RefWorks:173}. 
The $DEM$ parameters for the Young's modulus ($E$) and the Poisson's coefficient
($\nu$) were taken from the literature, see \cite{RefWorks:175} 
and \cite{RefWorks:176}; however we reduced the former to increase the time step
($\Delta t$), following the recommendations of Ai et al. \cite{RefWorks:131}.
The time step was between $1.29 \%$ and $1.53 \%$ of the Rayleigh time, which
also depends on the particle density ($\rho_p$).
Furthermore, we locked the size distribution, which was obtained by experimental
sieving, see Table \ref{tab:09DEMFixedinputvalues}.
In the contact law we used, 
the tangential component of the contact force between two generic particles
($F_t$) is truncated to fulfil:
%************************************************
\begin{equation}
F_{t} \leq \mu_s F_{n},
 \label{eq:force_t}
\end{equation}
%************************************************
where $F_n$ is the normal component and $\mu_s$ is the coefficient of sliding
friction, one of the particle-based $DEM$ parameter we investigated, 
another being the coefficient of rolling friction ($\mu_r$). 
For coarse non-spherical particles, this is a critical parameter and describes
inter-particle friction in medium to dense granular flow simulations. It is proportional to the 
torque counteracting the rotation of the particle. The $\mu_r$ parameter enters the 
equations according to the elasto-rolling resistance model presented by Wensrich and 
Katterfeld \cite{RefWorks:87} and Ai et al. \cite{RefWorks:131} 
based on the work of Jiang et al. \cite{RefWorks:143}. 
The model is called $EPSD2$ in $LIGGGHTS$ and is appropriate for both one-way and cyclical rolling cases.
The maximum magnitude of rolling resistance torque is (Eq. \ref{eq:trmax}):
%************************************************
\begin{equation}
T_{r~max} = \mu_r R_r |\tilde{F_n}| ~,
 \label{eq:trmax}
\end{equation}
%************************************************
where $R_r$ is the equivalent radius and $F_n$ the normal force.
The last two particle-based $DEM$ parameters we investigated were $\rho_p$
(see Section \ref{subsec:applicability})
and the coefficient of restitution ($COR$) as defined by Ai. et al.
\cite{RefWorks:131}.\\
Although the geometry differs, the $SSC$ was designed to obtain the same values for the shear 
stresses as the Jenike shear cell tester ($JSCT$), but with improved automation and reliability, 
see Schulze \cite{RefWorks:118}. For this reason, the simulation setup was based on the $JSCT$. 
As suggested by Aigner et al. \cite{RefWorks:139} and Benvenuti et al. \cite{RefWorks:173}, 
the diameter and the height of the rings operated in the simulations had to be sufficiently 
large to avoid relevant wall effects. 
However, a larger domain increases the number of particles and thus simulation time. 
For this reason, we considered the cylinder dimension ($dCylDp$), which is proportional to 
the mean particle diameter, as an additional $DEM$ parameter to be investigated. 
A simulation run comprised four phases. First, the shear cell was filled with
the granulate material, and it was allowed to settle. Then, the top lid was
lowered and the first normal stress applied to the bulk solid. The distance between the 
lid and the bottom of the domain multiplied by the simulation area gave the total volume, 
while the software already provided the total mass. 
The velocity of the ring displacement, and consequently the total simulation time, 
was determined by a trade-off between minimizing the normal load oscillation and optimizing computation time. 
The former requires (relatively) low velocity, and the latter requires high speed.\\
The coefficients, $COR$, $\mu_s$, $\mu_r$,
$\rho_p$ and $dCylDp$ (the cylinder dimension, proportional to the mean
particle diameter), as indicated in Table \ref{tab:10DEMVariableinputvalues}, 
were constant in each simulation, but their combination differed between
simulations.
Further, $dCylDp$ was used to evaluate the wall effect, but only $~10\%$ of the
simulations had a $dCylDp$ larger than $20$.
The normal stress $\sigma_n$ (1,068, 2,069, and 10,070 Pa) and its
percentage (40, 60, 80, and 100 \%) during the incipient flow condition
($\tau_{\%}$) varied to replicate twelve shear-cell load conditions. 
A Matlab script allowed us to extract from the simulation output the numerical
values representative of bulk behaviour (hereafter called \textit{bulk values}),
see Table \ref{tab:14bulkvalues}, for each $DEM$ simulation parameter combination.
For correctly performed simulations, we
observed a stress path as in Fig. \ref{fig:21simexample}.
First, the $\sigma_n$ was kept constant while the coefficient of internal
friction ($\mu_{ie}$) initially increased and then reached a plateau.
The second bulk value ($\mu_{psh}$) was calculated as the average of the
$\mu_{ie}$ in this plateau.
The $\sigma_n$ was then automatically reduced, in our example to $80 \%$ of
its initial value.
Subsequently, a second plateau developed.
We obtained the third
value ($\mu_{sh}$) as the average of $\mu_{ie}$ in this second plateau.
The stress path accords with the experimental one, especially the plateaux.\\
In $AoR$ simulations we sought to replicate meticulously the experimental setup,
considering both the plate and the liftable boundary, with the same domain size consideration as before. 
The particles had the same properties as in the shear-cell simulation. 
The first phase was identical to that of the shear-cell simulation. 
After lifting the boundary, the particles formed a heap. 
An image post-processing software was used to obtain the average slope, the fourth
bulk value, allowing us to define the numerical bulk behaviour.
%************************************************
\begin{figure}[htp] \centering
    \begin{subfigure}[b]{0.96\columnwidth}
        \includegraphics[width=\textwidth]{20experimental}
        \caption{Experimental shear-cell tester stress path - $\sigma_n = 10000
        ~Pa$}
        \label{fig:20experimental} 
    \end{subfigure}\\
        \begin{subfigure}[b]{0.96\columnwidth}
        \includegraphics[width=\textwidth]{21simexample}
        \caption{Numerical shear-cell tester stress path - $\sigma_n = 10000
        ~Pa$}
        \label{fig:21simexample} 
    \end{subfigure}
    \caption[Stress path]{Experimental and numerical samples of the stress path
    for the Schulze ring shear cell tester.
	Time was normalized: $\tilde{t} = t/t_{change}$, where $t_{change}$ is the
	point in time at which the normal stress ($\sigma_n$) was modified during the
	tests.
	Until $\tilde{t}=1$, the $\sigma_n$ was kept constant at 10,000 Pa. 
	In Fig. \ref{fig:20experimental}, 
 	a plateau was reached at $\tilde{t}~=0.91$.
	The coefficient of pre-shear ($\mu_{psh}$) was calculated as the average of the
	coefficient of internal friction ($\mu_{ie}$) in this first plateau.
	At $\tilde{t}=1$, the $\sigma_n$ was reduced to $80 \%$ of its initial
	value, and soon after
	a second plateau developed.
	We obtained the coefficient of
	shear ($ \mu_{sh}$) as the average of $\mu_{ie}$ in this second plateau.
	The stress paths agree well, especially the plateaux.
	They were clearly relevant because
	the values representative of the bulk behaviours 
	were collected there.}
    \label{fig:40experimentalsimulation}
\end{figure}
%************************************************
\begin{table}[h]
\centering
\begin{tabular}{ccccc}
\hline
    Mean & Std.dev.  & Young's & Poisson's & $\Delta t$\\
    $R$ & $R$ & modulus & ratio & \\
    (mm)  & (mm)  & (MPa) & (-) & (s)\\
    \hline
    $0.732$ & $0.41$ & $10$    & $0.40$ & $10^{-6}$\\
\hline
\end{tabular}
\caption{DEM fixed input values}
\label{tab:09DEMFixedinputvalues}
\end{table}
%************************************************
\begin{table}[h]
  \centering
    \begin{tabular}{lcc}
    \hline
     & acronym & formula \\ 
     \hline
    bulk density & $\rho_b$ & $\frac{mass ~ of ~ the ~ bulk}{volume ~ of ~ the ~ bulk}$ \\ 
    [5pt]
     
    steady-state flow/pre-shear coefficient of internal friction & $\mu_{psh}$
     & $\frac{\tau_{psh}}{\sigma_{n,psh}}$ \\      [5pt]
     
    incipient flow/shear coefficient of internal friction & $\mu_{sh}$ &
    $\frac{\tau_{sh}}{\sigma_{n,sh}}$ \\      [5pt]
     
    static angle of repose & AOR   & from the slope \\
\hline
    
    \end{tabular}%
  \caption{Values representative of bulk behaviour.}
\label{tab:14bulkvalues}
\end{table}%
%************************************************
\begin{table}[h]
\centering
\begin{tabular}{ccccc}
\hline
    $\mu_s$ & $\mu_r$ & $COR$ & $\rho_p$ & $dCylDp$ \\
    	(-)  & (-)   & (-)   & ($kg/m^3$) & (-) \\
    \hline
    0.4 / 0.6 / 0.8 & 0.4 / 0.6 / 0.8 & 0.5 / 0.7 / 0.9 & 2500 / 3000 / 3500 & 20 / 36 / 38 / 40 \\

\hline
\end{tabular}
\caption[DEM variable input values]{DEM variable input values for training the
Artificial Neural Networks}
\label{tab:10DEMVariableinputvalues}
\end{table}
%************************************************
\begin{table}[h]
\centering
\begin{tabular}{lcccc}
\hline
 &  $\mu_s$ & $\mu_r$ & $COR$ & $\rho_p$  \\
   &	(-)  & (-)   & (-)   & ($kg/m^3$) \\
          \hline
    range & $[0.1 \ldots 1.0]$ & $[0.1 \ldots 1.0]$ & $[0.5 \ldots 0.9]$ &
    $[2000 \ldots 3500]$     \\
    number of values & 100   & 100   & 25    & 25    \\

\hline
\end{tabular}
\caption[DEM random input values]{DEM random input values. Within each range the
indicated number of random values was chosen according to a standard uniform
distribution.}
\label{tab:12DEMRandominputvalues}
\end{table}
%************************************************

\subsection{Artificial Neural Networks}
\label{subsec:ann}

An Artificial Neural Network ($ANN$) is a powerful modelling technique, 
that is based on non-linear functions (Haykin \cite{RefWorks:158}). 
In this work, we first used the $ANN$ to fit the $DEM$ numerical simulation data, 
and then to process a vast number of parameters combinations. 
$ANNs$ map combinations of input data to convenient outputs (fitting). 
Especially, the validity of the Feedforward Multilayer Perceptron Neural Network ($MLPNN$) 
with a backpropagation reinforcement learning training algorithm (scaled conjugate gradient), 
has been demonstrated in the literature, see Haykin \cite{RefWorks:158}. Several scientists 
\cite{RefWorks:161, RefWorks:166, RefWorks:167, RefWorks:168, RefWorks:169,
RefWorks:170, RefWorks:178, RefWorks:179} have employed $ANNs$ to model the
mechanical properties of materials. Following the best practice suggested by Vaferi et al. \cite{RefWorks:150}, 
we used $MLPNNs$.\\ 
Our $ANNs$ have three different layers: the input layer has a number of neurons
equal to the number of different inputs of the network, see Fig. \ref{fig:18nnscheme}.
The hidden (or central) layer's number of neurons was to be investigated. 
The output layer contains one neuron for the output.
The transfer functions between the first two layers are the tangential sigmoid, 
and those between the hidden and output layers are linear.\\
Thus, we were able to use the $DEM$ parameter combinations and their
corresponding bulk values to train the $ANNs$.
Note that 15\% of the simulations (\textit{test simulations}) were
randomly picked and excluded from the training processes.
We started with all the $DEM$ parameter combinations and their corresponding
numerical $\mu_{psh}$ to create 36 $ANNs$ that differed in their numbers of
neurons in the hidden layer (between five to forty neurons).
We then determined the coefficient of determination ($R^2$) between the
$bulk-macro$ behaviours in the output of the $ANN$ and the 15\% \textit{test simulations}, 
which were not correlated with the remaining 85\% used for the training. 
Thus, we could select for $\mu_{psh}$ the $ANN$ with the maximum $R^2$, 
again as suggested by Vaferi et al. \cite{RefWorks:150}, and we noted its number
of neurons.
We repeated the same $ANN$ creation steps for $\mu_{sh}$, $\rho_b$
and $AoR$, obtaining one trained $ANN$ for each bulk value. \\
Since $\mu_{psh}$, $\mu_{sh}$ and $\rho_b$ belonged to the shear-cell
simulations, their $ANNs$ were handled together: we had one cluster with three 
$ANNs$ for the shear cell and one with only one $ANN$ for the $AoR$.
We could then proceed in identifying valid input parameters.
Oberkampf et al. \cite{RefWorks:160} suggested using a Design of Experiments
($DoE$) method to determine the parameter combinations to be simulated.
They stated that this approach allows optimization of computation time
with an acceptable loss of precision.
Further, the quality of the $ANN$ data had to be examined critically. 
Haykin \cite{RefWorks:158} suggested considering the quality of 
(a) $ANN$ training process and (b) the subsequent data generation based on the inputs provided. 
Task (a) is particularly important when dealing with experimental training data, 
and usually addressed by noise-corrupted pattern calibration. 
However, our training pool was numerical and extensive, and the particles in 
our simulations were inserted using a random seed value. For vast amounts of training data, 
the effect of noise-corrupted patterns is negligible, see Haykin \cite{RefWorks:158}. 
Thus, in our work task (b) was more challenging. Once trained, the $ANN$ were fed combinations of $DEM$ parameters. \\
Instead of following Oberkampf's suggestion, 
the speed of the trained $ANNs$ enabled us to follow a different approach to
maximizing the precision of the characterization and to increasing the
generalization.
We created random values
in the range and numbers defined in Table \ref{tab:12DEMRandominputvalues}
according to a standard uniform distribution for each parameter investigated.
The total number of combinations of these random values was 6,250,000.
These combinations were then fed to and processed by the selected
$ANNs$, and thus three bulk values for the shear
cell and one for the $AoR$ were obtained.
At this point we could use the $ANNs$ as a tool to deliver parameters for the
specific contact law, which was not questioned further.
However, if the contact law was not appropriate this methodology might help in
identifying the $DEM$ deficiencies related to it.
%************************************************
\begin{figure}[!htb] 
\centering 
\includegraphics[width=.96\textwidth]{18nnscheme} 
\caption[ANN Scheme]{Artificial Neural Network ($ANN$) Scheme
of how the Multilayer Perceptron $ANN$ ($MLPNN$) derives one
bulk-behaviour-dependent variable from the mutually independent simulation variables.}
\label{fig:18nnscheme} 
\end{figure}
%************************************************

\subsection{Macroscopic Experiments and Parameter Identification}
\label{subsec:macroscopicexperimentsparameteridentification}

A representative sample of bulk solid was placed in a Schulze ring shear cell
($SSC$) of specified dimensions ($external ~ radius = 100 ~ mm$, $internal ~ radius = 50 ~ mm$), 
see Schulze \cite{RefWorks:118}. Once checked that the material was cohesionless,  
we obtained for each of the twelve load conditions of the $SSC$ three bulk
values ($\mu_{psh}$, $\mu_{sh}$ and $\rho_b$). \\
Later, a sample was deposited on a 20 cm diameter plate with liftable boundary
called static angle of repose ($AoR$) tester. 
Once the particles were in position, the boundary was lifted, allowing some particles to drop. 
Once stabilized, the $AoR$ was measured eight times using a digital protractor at different 
positions of the heap. The average of the measurements gave the fourth bulk value. 
Note that, since the experiments were performed only for larger-size bulk solids, 
the compaction condition in the initial state was not critical to the final
result. \\
Subsequently, we compared the $ANN$ and experimental bulk behaviours for the
twelve shear-cell load conditions.
If in a DEM-parameter combination all the three bulk values differed by less 
than 5\% from those of the corresponding experiments, i.e.:
%************************************************
\begin{equation}
 \begin{cases}
\text{if } & \lvert{1-\frac{\mu_{psh,num}}{\mu_{psh,exp}}}\rvert < 5\%  ,\\
\text{and if } & \lvert{1-\frac{\mu_{sh,num}}{\mu_{sh,exp}}}\rvert < 5\% , \\ 
\text{and if } & \lvert{1-\frac{\rho_{p,num}}{\rho_{p,exp}}}\rvert < 5\% ,\\ 
\end{cases}
 \label{eq:check2}
\end{equation}
%************************************************
the combination was marked. The marked combinations were processed by the
$AoR$ $ANN$, and then compared with the experiment.
Were considered valid those that differed by less than 5\% also in this
comparison (Eq. \ref{eq:checkaor}):
%************************************************
\begin{equation}
\text{if} ~~~~~~ \lvert{1-\frac{AoR_{num}}{AoR_{exp}}}\rvert < 5\% .
\label{eq:checkaor}
\end{equation}
%************************************************
These parameters are to be considered valid for the defined contact law (and
flow regime). Further, to prove the validity of the system, we tested the marked
combinations by modifying the experimental bulk values of the shear cell. 
We artificially decreased or increased the shear force, and thus $\mu_{psh}$ and
$\mu_{sh}$, by a product coefficient ($P$), e.g. Eq. \ref{eq:pcoeff}:
%************************************************
\begin{equation}
\label{eq:pcoeff}
\mu_{psh, new} = \mu_{psh, old} \cdot P .
\end{equation}
%************************************************

\section{Results and discussion}
\label{sec:results}
%************************************************

\subsection{DEM Simulations}
\label{subsec:simulations}

For sinter fine, 546 shear cell and 81 static $AoR$ simulations were run with
the parameter combinations described in Table
\ref{tab:10DEMVariableinputvalues}.
The computational time amounted to 1 hour with 32 AMD cores for a benchmark
shear-cell simulation and to 9 hours for a benchmark $AoR$ simulation, both with
50,000 particles.
Simulations with larger $dCylDp$ required more time (e.g., about 12 hours for
the shear cell with 400,000 particles). \\


\subsection{ANN model development}
\label{subsec:annmodeldev}

First, we determined the regression of the bulk behaviour parameters, for
instance the $\mu_{psh}$; see Fig. \ref{fig:22regression}, where the
corresponding plot for the $ANN$ with the maximum $R^2$ is shown. Each circle represents one of the 546
simulations.
The plot shows a consistent agreement between the 
$DEM$ and the $ANN$ values and an almost linear regression ($R^2
= 0.94$).
The linear relationship between the
training values can be seen in Table \ref{tab:06inputRelationshipTable}.
The clearest connections were between $\mu_s$ and $\mu_{psh}$, and
$\rho_p$ and $\rho_b$.
In contrast, for $\mu_{sh}$ and $AoR$, the $\mu_r$ balanced the influence of the 
$\mu_s$. \\
We then investigated how the $R^2$ changed with the number of neurons
for the $\mu_{psh}$.
In this case, we achieved a $R^2 = 0.96$ for an $ANN$ with fifteen neurons. 
Increasing the number of neurons did not improve the $R^2$; it even started to
oscillate with higher numbers of neurons.
We subsequently obtained the optimal number of neurons for all $ANNs$.
Further, we processed the random combinations (Table
\ref{tab:10DEMVariableinputvalues}) with the $ANN$.
The $ANN$ evaluation was significantly faster than the $DEM$ simulations. The
individuation of the numerical bulk behaviours for all the $DEM$ combinations
did not take more than a few seconds on a single core.
%************************************************
\begin{figure}[!h] 
\centering 
\includegraphics[width=.96\textwidth]{22regression}
%[width=.96\textwidth]
\caption[Comparison between prediction of the trained ANN and full DEM
simulation]{Comparison between prediction of the trained Artificial Neural
Network ($ANN$) and 546 full DEM simulations of the coefficient of pre-shear
($\mu_{psh}$). In this case the regression line is nearly linear (0.94), and
demonstrates the accurate predictive power of the $ANN$.}
\label{fig:22regression} 
\end{figure}
%************************************************
\begin{table}[h]
\centering
\scalebox{1.0}{
\begin{tabular}{lcccccccc}
\hline
         & $\mu_s$ & $\mu_r$ & $COR$ & $\rho_p$ & $\mu_{sh}$ &
        $\mu_{psh}$ & $\rho_{b}$ & $AoR$ \\
          \hline
    $\mu_s$ & 100.00 & 0.55  & 0.04  & 0.00  & 3.84  & 87.26 & 8.39  & 49.48 \\
    $\mu_r$ & 0.55  & 100.00 & 0.15  & 0.00  & 58.92 & 33.70 & 3.10  & 60.20 \\
    $COR$ & 0.04  & 0.15  & 100.00 & 0.00  & 15.52 & 0.57  & 1.71  & 21.35 \\
    $\rho_p$ & 0.00  & 0.00  & 0.00  & 100.00 & 4.98  & 5.71  & 99.00 & 0.00 \\
    $\mu_{sh}$ & 3.84  & 58.92 & 15.52 & 4.98  & 100.00 & 26.03 & 9.52  & 0.00 \\
    $\mu_{psh}$ & \textbf{87.26} & 33.70 & 0.57  & 5.71  & 26.03 & 100.00 & 4.33 
    & 0.00
    \\
    $\rho_{b}$ & 8.39  & 3.10  & 1.71  & \textbf{99.00} & 9.52  & 4.33  & 100.00
    & 0.00 \\
    $AoR$ \hspace{5ex} & 49.48 & \textbf{60.20} & 21.35  & 0.00  & 0.00  & 0.00 
    & 0.00  & 100.00 \\
    
\hline
\end{tabular}}
\caption[Values of linear relationship between considered variables]{Values of
linear relationship between variables considered multiplied by 100. Sliding
friction ($\mu_s$), rolling friction ($\mu_r$) and particle density ($\rho_p$)
had the greatest influence on, respectively, the coefficient of pre-shear
($\mu_{psh}$), the angle of repose  ($AoR$) and the bulk density ($\rho_b$). Notably, $\rho_p$
was not used as a training parameter for $AoR$ bulk behaviour.}
\label{tab:06inputRelationshipTable}
\end{table}
%************************************************


\subsection{Experiments and Parameter Identification}
\label{subsec:experimentsparameteridentification}

Experimental values identifying the bulk behaviour, $\mu_{psh}$, $\mu_{sh}$ and
$\rho_{b}$, of sinter fine were acquired through $SSC$ tests. 
Table \ref{tab:05sinterTableExperimental} presents
these values for three load conditions: clearly the $\mu_{psh}$ decreases, and 
the $\mu_{sh}$ oscillates.
The $\rho_b$ has a clear average of 1,760 $kg/m^3$ with a 42 
$kg/m^3$ deviation.
The stress path for the second load condition in Table
\ref{tab:05sinterTableExperimental} is shown in Fig.
\ref{fig:20experimental}.
Two $AoR$ tests were performed that gave an average angle of
38.85$^\circ$.
We obtained the radius ($R$) mean and standard
deviations, as shown in Table
\ref{tab:09DEMFixedinputvalues}, from sieving experiments.
Initially, we investigated the comparison between numerical and experimental
behaviours for one load condition of
the shear cell ($\sigma_n=1,068$ Pa, P=1.0), as plotted in Fig.
\ref{fig:41radarpirker1schulze1068}. 
Later, the comparison between numerical and experimental behaviours led to a
first series of marked combinations ($MC1$) for one load condition of
the shear cell ($\sigma_n=10,070$ Pa, P=1.0), as plotted in Fig.
\ref{fig:24radarpirker1schulze10070}, where 
the minimum and maximum values are shown, together with the mean. 
Note that the confidence interval is large, 
especially for the $COR$, which highlights its insignificant influence on the
characterization.
Compared to the smaller normal load,
both the $\rho_p$  and the $\mu_s$, however, show a narrow confidence interval, 
which demonstrates their influence and the ability of this procedure to find
valid $DEM$ parameters.
These results agree with our examination of the ratio of the standard deviation
to the range, see Table \ref{tab:13DEMvalidvalues}.
Further, we observed that various $DEM$ parameter
combinations could reproduce the experimental behaviour, and thus we evaluated
their mutual dependencies.
This is shown more clearly in a density plot (see Fig. 
\ref{fig:25cloudpirker1schulze10070} for $MC1$) 
of the particles' coefficient of restitution ($COR$) in relation to
the coefficients of sliding friction ($\mu_s$) and rolling friction ($\mu_r$). 
Multiple
combinations (250,407 or 4\% of the total) of $\mu_s$ and $\mu_r$ reproduced
the experimental behaviour with varying $COR$.
This underlines once more their correlation, as already stated by Wensrich and 
Katterfeld \cite{RefWorks:87}.
Compared to the $\sigma_n=1,068$ Pa, P=1.0, we cannot claim that is in general
possible to extrapolate information to other flow regimes: the parameters sets obtained are 
slightly different. Especially, the parameter combinations valid for both sets are 
unrealistically limited (less than one hundred). This, in turn, gives an indication that the 
functional particle behaviour, we have chosen for the $DEM$ simulations is not
able to correctly predict both macroscopic flow regimes. However, in this case
we can argue that our $ANN$ parameter identification approach can help in 
evaluating the predictive capability of a defined functional particle behaviour. 
To further demonstrate the validity of the procedure, we modified the product
coefficient for $\sigma_n=10,070$ Pa. 
First, we set it to $P=0.8$, and we obtained another
series of marked combinations ($MC2$).
It can be seen in the parameter space plot in Fig.
\ref{fig:26radarpirker08schulze10070} that the confidence range is narrower
than for $P=1.0$, while in the density plot in Fig. 
\ref{fig:27cloudpirker08schulze10070} the area
appears larger, although slightly less densely populated. Finally, for $P=1.2$
and its marked combinations ($MC3$) the parameter space plot in Fig.
\ref{fig:28radarpirker12schulze10070} shows a largely different confidence
range, while the density plot in Fig. \ref{fig:30cloudpirker12schulze10070} 
shows a smaller area. As expected, the procedure was highly sensitive to
variations in the experimental data.
Our approach could therefore be used in specific flow regimes for a range of
bulk materials that can be represented with a defined particle bulk behaviour.\\
We then processed the random combinations with the $AoR$ $ANN$. In Fig.
\ref{fig:31radarpirker1aor} the parameter space plot for the same criteria as
before can be seen.
In accordance with theory (Wensrich and Katterfeld \cite{RefWorks:87}), in a simulation dominated
by rolling particles, the coefficient of rolling friction has the maximum
influence. \\
Finally, we extracted from the $MC1$ ($\sigma_n=10,070$ Pa, P=1.0) values the
$AoR$ $ANN$ behaviour and compared it with the experimental one.
As can be seen in the parameter space plot in Fig.
\ref{fig:33radarpirker1schulze10070aor}, the confidence interval is very small,
indicating that all the parameters but the $COR$ played an important role, 
and demonstrating the reliability of these parameter
combinations in representing the bulk behaviour.
From the initial 6,250,000 combinations, only 3,884 were valid (0.0621
\%), see Table \ref{tab:13DEMvalidvalues}.
%************************************************
\begin{table}[h]
\centering
\begin{tabular}{cccccc}
\hline
$\sigma_n$ (Pa) & $\tau$ (Pa) & $\mu_{psh}$ (-) & $\tau_{\%}$ (\%) &
$\mu_{sh}$ (-) & $\rho_b$ ($kg/m^3$) \\
\hline
    1,068  & 1059  & 0.9916 & 80 & 1.2333 & 1718 \\
    2,069  & 1818  & 0.8787 & 80 & 0.9994 & 1759 \\
    1,0070 & 8232  & 0.8175 & 80 & 1.1712 & 1802 \\

\hline
\end{tabular}
\caption[Experimental results]{Experimental results. Values for three
load conditions}
\label{tab:05sinterTableExperimental}
\end{table}
%************************************************
\begin{table}[h]
\centering
\begin{tabular}{llccc}
\hline

          & type  & SSC & AoR   & SSC \& AoR \\
          \hline

    $\mu_s$ & mean  & 0.831 & 0.177 & 0.664 \\
    $(-)$   & std. dev. (SD) & 0.097 & 0.095 & 0.029 \\
          & range ($R$) & 0.9   & 0.9   & 0.9 \\
          & SD / R & 0.108 & 0.106 & 0.032 \\
          \hline
    $\mu_r$ & mean  & 0.692 & 0.830 & 0.916 \\
    $(-)$   & std. dev. (SD) & 0.215 & 0.193 & 0.042 \\
          & range ($R$) & 0.9   & 0.9   & 0.9 \\
          & SD / R & 0.239 & 0.214 & 0.046 \\
          \hline
              COR   & mean  & 0.708 & 0.590 & 0.590 \\
    $(-)$   & std. dev. (SD) & 0.104 & 0.073 & 0.065 \\
          & range ($R$) & 0.4   & 0.4   & 0.4 \\
          & SD / R & 0.259 & 0.183 & 0.161 \\
          \hline
    $\rho_p$ & mean  & 2245.7 & 3192.8 & 2283.9 \\
    $(kg/m^3)$ & std. dev. (SD) & 80.5  & 277.4 & 67.1 \\
          & range ($R$) & 1500  & 1500  & 1500 \\
          & SD / R & 0.054 & 0.185 & 0.045 \\
          \hline
    valid & number & 290203 & 816552 & 3884 \\
    combinations & (\%) & 4.64  & 13.06 & 0.06 \\  

\hline
\end{tabular}
\caption[Valid DEM values]{Valid DEM values. For each parameter we show the
valid parameter statistics in the two tests and in their intersection.
Finally, we show the number of valid parameter combinations over the total
(6,250,000).}
\label{tab:13DEMvalidvalues}
\end{table}
%************************************************
\begin{figure}[!h] 
\centering 
\includegraphics[width=.96\textwidth]{41radarpirker1schulze1068}
%[width=.96\textwidth]
\caption[Parameter space plot of valid simulations parameters for one
    bulk behaviour measured by SSC]{Parameter space plot of valid simulation
    parameters for one bulk behaviour measured by a shear cell
    tester ($SSC$).
    Each axis of the parameter space plot represents one simulation parameter.
    The shaded area indicates valid parameter combinations, and dark shaded
    values indicate the confidence range.
	The marked combinations for $\sigma_n=1,068$ Pa are presented.
    Further explanations can be found in
   Section \ref{subsec:experimentsparameteridentification}}
\label{fig:41radarpirker1schulze1068}
\end{figure}
%************************************************
\begin{figure}[htp] \centering
        \begin{subfigure}[b]{0.5\columnwidth}
        \includegraphics[width=\textwidth]{26radarpirker08schulze10070}
        \caption{Parameter space plot, $SSC$, $\sigma_n=10,070$ Pa, P=0.8}
        \label{fig:26radarpirker08schulze10070} 
    \end{subfigure}\\
     \begin{subfigure}[b]{0.5\columnwidth}
        \includegraphics[width=\textwidth]{24radarpirker1schulze10070}
        \caption{Parameter space plot, $SSC$, $\sigma_n=10,070$ Pa, P=1.0}
        \label{fig:24radarpirker1schulze10070}
    \end{subfigure} \\
        \begin{subfigure}[b]{0.5\columnwidth}
        \includegraphics[width=\textwidth]{28radarpirker12schulze10070}
        \caption{Parameter space plot, $SSC$, $\sigma_n=10,070$ Pa, P=1.2}
        \label{fig:28radarpirker12schulze10070} 
    \end{subfigure}
    \caption[Parameter space plot of valid simulations parameters for three different
    bulk behaviours measured by SSC]{Parameter space plot of valid simulation
    parameters for three different bulk behaviours measured by a shear cell
    tester ($SSC$).
    Each axis of the parameter space plot represents one simulation parameter.
    The shaded area indicates valid parameter combinations, and dark shaded
    values indicate the confidence range.
	The marked combinations for $\sigma_n=10,070$ Pa are presented.
    Further explanations can be found in
   Section \ref{subsec:experimentsparameteridentification}.
   }
    \label{fig:29schulzeradarandcloud}
\end{figure}
%************************************************
\begin{figure}[htp] \centering

    \begin{subfigure}[b]{0.8\columnwidth}
        \includegraphics[width=\textwidth]{27cloudpirker08schulze10070}
        \caption{Density plot, $SSC$, $\sigma_n=10,070$ Pa, P=0.8}
        \label{fig:27cloudpirker08schulze10070} 
    \end{subfigure}\\
    \begin{subfigure}[b]{0.8\columnwidth}
        \includegraphics[width=\textwidth]{25cloudpirker1schulze10070}
        \caption{Density plot, $SSC$, $\sigma_n=10,070$ Pa, P=1.0}
        \label{fig:25cloudpirker1schulze10070}
    \end{subfigure}\\

    \begin{subfigure}[b]{0.8\columnwidth}
        \includegraphics[width=\textwidth]{30cloudpirker12schulze10070}
        \caption{Density plot, $SSC$, $\sigma_n=10,070$ Pa, P=1.2}
        \label{fig:30cloudpirker12schulze10070} 
    \end{subfigure}
    \caption[Density plot comparison of SSC results]{Density plot comparison of
    shear cell tester ($SSC$) results. The marked combinations for
    $\sigma_n=10,070 ~Pa$ are presented.
    Density plot of the particles' coefficient of restitution (COR) as a
    function of the coefficient of sliding friction ($\mu_s$) and the
    coefficient of rolling friction ($\mu_r$); 
    in the white area, no valid sets of simulation parameters can be found.
	In each cell the valid sets are grouped according to the 4 different COR
	ranges.
	Each cell is coloured according to the group with the most members. 
    The values plotted here were initially
    selected between the numerical
    values from the Artificial Neural Network with the original
    experimental results for the $SSC$, with a product coefficient $P=1.0$ (Fig.
    \ref{fig:25cloudpirker1schulze10070}). 
    Subsequently, they were chosen with  
    a lower virtual shear stress ($P=0.8$)
    (\ref{fig:27cloudpirker08schulze10070}).
    The last image (Fig. \ref{fig:30cloudpirker12schulze10070}) represents
    the selection with a higher virtual shear stress ($P=1.2$).    }
    \label{fig:29schulzeradarandcloud}
\end{figure}
%************************************************
\begin{figure}[htp] \centering
    \begin{subfigure}[b]{0.96\columnwidth}
        \includegraphics[width=\textwidth]{31radarpirker1aor}
        \caption{Parameter space plot, $AoR_{exp} = 38.85 ^\circ$}
        \label{fig:31radarpirker1aor} 
    \end{subfigure}\\
        \begin{subfigure}[b]{0.96\columnwidth}
        \includegraphics[width=\textwidth]{33radarpirker1schulze10070aor}
        \caption{Parameter space plot, $AoR_{exp} = 38.85
        ^\circ$ \& $SSC$: $\sigma_n=10,070$ Pa}
        \label{fig:33radarpirker1schulze10070aor} 
    \end{subfigure}
    \caption[Parameter space plots of valid simulation parameters for the AoR
    and the combination of AoR and SSC valid parameters]{Parameter space plots
    of valid simulation parameters for the angle of repose tester ($AoR$) and the
    combination of $AoR$ and shear cell tester ($SSC$).
    Each axis of the parameter space plot represents one simulation parameter.
    The shaded area 
    and dark shaded values indicate
    valid parameters combinations and
    the confidence interval, respectively.
    Further explanations are given in Section
    \ref{subsec:experimentsparameteridentification}.}
    \label{fig:35schulze10070aorradarandcloud}
\end{figure}
%************************************************
%************************************************
\section{Conclusions}
\label{sec:conclusions}
%************************************************
We have presented a two-step method for $DEM$ simulation parameter
identification. In the first step, an artificial neural network is 
trained using dedicated $DEM$ simulations in order to predict bulk 
behaviours as function of a set of $DEM$ simulation parameters of a given
contact law.
In the second step, this artificial neural network is then used 
to predict the bulk behaviour of a huge number of additional $DEM$ parameter
sets of the same contact law.
The main findings of this study can be summarized as follows:
\begin{itemize}
  \item{An artificial neural network can be trained by a limited number of
  		dedicated $DEM$ simulations.
  		The trained artificial neural network is then able to predict
  		granular bulk behaviour.}
  \item{This prediction of granular bulk behaviour is much more efficient
  		than computationally expensive $DEM$ simulations.
  		Thus, the macroscopic output associated with a huge number of parameter sets
  		can be studied.}
  \item{If the predictions of the artificial neural network are compared to a bulk experiment, 
  		valid sets of $DEM$ simulation parameters can be readily deduced for a
  		specific granular material.}
  \item{This $DEM$ parameter identification method can be applied to
  		arbitrary bulk experiments over the same material.
  		Combining two artificial neural networks which predict two different bulk
  		behaviours leads to winnowing the set of valid $DEM$ simulation parameters.}
  \item{In turn, an empty intersection between the networks would be a clear
  		indication that the chosen contact law is not appropriate.}
  \item{Artificial neural networks can establish the complicated relationship
  		between microscopic $DEM$ parameters of a given contact law and macroscopic
  		properties of granular materials with less $DEM$ simulations than direct
  		procedures.}
\end{itemize}
As part of future work, we will develop this method further by considering
different fractions of granular materials, which will lead to size-dependent sets of $DEM$
simulation parameters.
%************************************************

\section{Acknowledgements}
This study was funded by the Christian Doppler Forschungsgesellschaft, Siemens
VAI Metals Technologies, and Voestalpine Stahl. The authors gratefully
acknowledge their support.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{elsarticle-num}
%\bibliography{Bibliografia}

\begin{thebibliography}{10}
\expandafter\ifx\csname url\endcsname\relax
  \def\url#1{\texttt{#1}}\fi
\expandafter\ifx\csname urlprefix\endcsname\relax\def\urlprefix{URL }\fi
\expandafter\ifx\csname href\endcsname\relax
  \def\href#1#2{#2} \def\path#1{#1}\fi

\bibitem{RefWorks:130}
P.~W. Cleary, M.~L. Sawley, Dem modelling of industrial granular flows: 3d case
  studies and the effect of particle shape on hopper discharge, Applied
  Mathematical Modelling 26~(2) (2002) 89--111.

\bibitem{RefWorks:172}
P.~A. Cundall, O.~D.~L. Strack,
  \href{http://www.icevirtuallibrary.com/content/article/10.1680/geot.1979.29.1.47}{A
  discrete numerical model for granular assemblies}, Geotechnique 29~(Volume
  29, Issue 1) (1979) 47--65(18).
\newline\urlprefix\url{http://www.icevirtuallibrary.com/content/article/10.1680/geot.1979.29.1.47}

\bibitem{RefWorks:148}
L.~Vu-Quoc, X.~Zhang, An accurate and efficient tangential force-displacement
  model for elastic frictional contact in particle-flow simulations, Mechanics
  of Materials 31~(4) (1999) 235--269.

\bibitem{RefWorks:145}
A.~D. Renzo, F.~P.~D. Maio, Comparison of contactforce models for the
  simulation of collisions in dembased granular flow codes, Chemical
  Engineering Science 59~(3) (2004) 525--541.

\bibitem{RefWorks:87}
C.~M. Wensrich, A.~Katterfeld, Rolling friction as a technique for modelling
  particle shape in dem, Powder Technology 217~(0) (2012) 409--417.

\bibitem{RefWorks:136}
C.~Kloss, C.~Goniva, A.~Hager, S.~Amberger, S.~Pirker,
  \href{http://dx.doi.org/10.1504/PCFD.2012.047457}{Models, algorithms and
  validation for opensource dem and cfddem}, Progress in Computational Fluid
  Dynamics, an International Journal 12~(2) (2012) 140--152.
\newline\urlprefix\url{http://dx.doi.org/10.1504/PCFD.2012.047457}

\bibitem{RefWorks:139}
A.~Aigner, S.~Schneiderbauer, C.~Kloss, S.~Pirker, Determining the coefficient
  of friction by shear tester simulation, 3rd International Conference on
  Particle-Based Methods (2013) 335--342.

\bibitem{RefWorks:86}
D.~Hohner, S.~Wirtz, V.~Scherer, A numerical study on the influence of particle
  shape on hopper discharge within the polyhedral and multi-sphere discrete
  element method, Powder Technology 226~(0) (2012) 16--28.

\bibitem{RefWorks:131}
J.~Ai, J.-F. Chen, J.~M. Rotter, J.~Y. Ooi, Assessment of rolling resistance
  models in discrete element simulations, Powder Technology 206~(3) (2011)
  269--282.

\bibitem{RefWorks:177}
M.~Combarros, H.~J. Feise, H.~Zetzener, A.~Kwade, Segregation of particulate
  solids: Experiments and dem simulations, Particuology 12~(0) (2014) 25--32.

\bibitem{RefWorks:91}
A.~Alenzi, M.~Marinack, C.~F. Higgs, J.~J. McCarthy, Dem validation using an
  annular shear cell, Powder Technology 248~(0) (2013) 131--142.

\bibitem{RefWorks:181}
M.~Paulick, M.~Morgeneyer, A.~Kwade, Review on the influence of elastic
  particle properties on dem simulation results, Powder Technology 283~(0)
  (2015) 66--76.

\bibitem{RefWorks:186}
S.~Lommen, D.~Schott, G.~Lodewijks, Dem speedup: Stiffness effects on behavior
  of bulk material, Particuology 12~(0) (2014) 107--112.

\bibitem{RefWorks:140}
S.~Luding, Introduction to discrete element methods, basics of contact force
  models and how to perform the micromacro transition to continuum theory,
  EJECE 12 (2008) 785--826.

\bibitem{RefWorks:190}
V.~Vidyapati, Constitutive modeling of dense granular flow based on discrete
  element method simulations, Ph.D. thesis, Iowa State University (2012).

\bibitem{RefWorks:150}
B.~Vaferi, F.~Samimi, E.~Pakgohar, D.~Mowla, Artificial neural network approach
  for prediction of thermal behavior of nanofluids flowing through circular
  tubes, Powder Technology 267~(0) (2014) 1--10.

\bibitem{RefWorks:174}
I.~Witten, E.~Frank, M.~Hall, Data Mining: Practical machine learning tools and
  techniques, Morgan Kaufmann, 2005.

\bibitem{RefWorks:158}
S.~Haykin, \href{http://books.google.com.pk/books?id=K7P36lKzI\_QC}{Neural
  Networks and Learning Machines}, no. v. 10, Prentice Hall, 2009, 2008034079.
\newline\urlprefix\url{http://books.google.com.pk/books?id=K7P36lKzI\_QC}

\bibitem{RefWorks:191}
Y.-H. Yang, Fundamental study of pore formation in iron ore sinter and pellets,
  Ph.D. thesis, University of Wollongong (1990).

\bibitem{RefWorks:183}
B.~Harthong, J.~F. Jrier, P.~Dormus, D.~Imbault, F.~V. Donz, Modeling of
  high-density compaction of granular materials by the discrete element method,
  International Journal of Solids and Structures 46~(1819) (2009) 3357--3364.

\bibitem{RefWorks:182}
V.~Baranau, D.~Hlushkou, S.~Khirevich, U.~Tallarek, Pore-size entropy of random
  hard-sphere packings.

\bibitem{RefWorks:185}
V.~Baranau, U.~Tallarek, Random-close packing limits for monodisperse and
  polydisperse hard spheres.

\bibitem{RefWorks:173}
L.~Benvenuti, A.~Aigner, D.~Queteschiner, M.~Combarros, S.~Pirker, C.~Kloss,
  Establishing the predictive capabilities of dem simulations: sliding and
  rolling friction coefficients of non-spherical particles, in: CFD 2014
  Proceedings, 2014.

\bibitem{RefWorks:175}
N.~Tsafnat, N.~Amanat, A.~S. Jones, Analysis of coke under compressive loading:
  A combined approach using microcomputed tomography, finite element analysis,
  and empirical models of porous structures, Fuel 90~(1) (2011) 384--388.

\bibitem{RefWorks:176}
J.~Kovacik, Correlation between young modulus and porosity in porous materials,
  Journal of Material Science 18 (1999) 1007--1010.

\bibitem{RefWorks:143}
M.~J. Jiang, H.~S. Yu, D.~Harris, A novel discrete model for granular material
  incorporating rolling resistance, Computers and Geotechnics 32~(5) (2005)
  340--357.

\bibitem{RefWorks:118}
D.~Schulze, Powders and bulk solids: behavior, characterization, storage and
  flow, Springer, 2008.

\bibitem{RefWorks:161}
S.~J. Antony, C.~H. Zhou, X.~Wang, An integrated mechanistic-neural network
  modelling for granular systems, Applied Mathematical Modelling 30~(1) (2006)
  116--128.

\bibitem{RefWorks:166}
A.-K. Seghouane, Y.~Moudden, G.~Fleury,
  \href{http://dx.doi.org/10.1007/s00521-004-0411-6}{Regularizing the effect of
  input noise injection in feedforward neural networks training}, Neural
  Computing and Applications 13~(3) (2004) 248--254, j2: Neural Comput and
  Applic.
\newline\urlprefix\url{http://dx.doi.org/10.1007/s00521-004-0411-6}

\bibitem{RefWorks:167}
D.~Barrasso, A.~Tamrakar, R.~Ramachandran, A reduced order pbm-ann model of a
  multi-scale pbm-dem description of a wet granulation process, Chemical
  Engineering Science~(0).

\bibitem{RefWorks:168}
T.~Varol, A.~Canakci, S.~Ozsahin, Artificial neural network modeling to effect
  of reinforcement properties on the physical and mechanical properties of
  al2024-b4c composites produced by powder metallurgy, Composites Part B:
  Engineering 54~(0) (2013) 224--233.

\bibitem{RefWorks:169}
A.~Canakci, S.~Ozsahin, T.~Varol, Modeling the influence of a process control
  agent on the properties of metal matrix composite powders using artificial
  neural networks, Powder Technology 228~(0) (2012) 26--35.

\bibitem{RefWorks:170}
M.~Lashkarbolooki, B.~Vaferi, M.~R. Rahimpour, Comparison the capability of
  artificial neural network (ann) and eos for prediction of solid solubilities
  in supercritical carbon dioxide, Fluid Phase Equilibria 308~(1-2) (2011)
  35--43.

\bibitem{RefWorks:178}
B.~Das, U.~P. Ganguly, N.~Bar, S.~K. Das, Holdup prediction in inverse
  fluidization using non newtonian pseudoplastic liquids: Empirical correlation
  and ann modeling, Powder Technology 273~(0) (2015) 83--90.

\bibitem{RefWorks:179}
S.~M. Turp, B.~Eren, A.~Ates, Prediction of adsorption efficiency for the
  removal of nickel(ii) ions by zeolite using artificial neural network(ann)
  approach, Fresenius Environmental Bulletin 20~(12) (2011) 3158--3165.

\bibitem{RefWorks:160}
W.~L. Oberkampf, C.~J. Roy,
  \href{http://books.google.com.pk/books?id=7d26zLEJ1FUC}{Verification and
  Validation in Scientific Computing}, Cambridge University Press, 2010.
\newline\urlprefix\url{http://books.google.com.pk/books?id=7d26zLEJ1FUC}

\end{thebibliography}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand\thefigure{\arabic{figure}}

\end{document}