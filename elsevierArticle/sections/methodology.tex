\section{Methodology of DEM Parameter Identification}
\label{sec:methodology}

We now illustrate the methodology used, also shown in Fig.
\ref{fig:19methodology}.
The experimental characterization has been performed as described in
\ref{subsec:srsctexperiment} and \ref{subsec:aorexperiment}. We performed
three tests with the $SRSCT$ for the sinter fine bulk, for a total of twelve
load conditions. 
The first bulk behaviour representative value ($\rho_b$) was directly provided. 
If the test was performed correctly, see \ref{subsec:srsctexperiment}, we
observed a linear increase in the coefficient of internal friction.
Later, the first plateau was reached. 
The second bulk behaviour representative value ($\mu_{psh}$) was calculated by averaging the coefficient in this plateau. 
Further, the normal load ($\sigma_n$) was modified, and then a second plateau
was reached.
The third value ($\mu_{sh}$) was determined by averaging the coefficient in this plateau. 
Next, we performed two $AOR$ tests. 
The average of the repose angles provided us the fourth bulk value, allowing us
to define the experimental bulk behaviour.
For simulations purposes, we also sieved the bulk to know the size distribution.
We could then focus on the simulations. 
As stated in the modelling section of this paper, we decided to fix one single
contact law for all the simulations performed.
Furthermore, we locked the size distribution, as provided by the sieving, the
elastic coefficients and the time step, see table
\ref{tab:09DEMFixedinputvalues}.
The last was between $1.29 \%$ and $1.53 \%$ of the Rayleigh time, that depends
to the particle density.
Other coefficients, $COR$, $\mu_s$, $\mu_r$,
$\rho_p$ and $dCylDp$, as indicated in table \ref{tab:10DEMVariableinputvalues},
were constant in each simulation, but their combination differed between
simulations.
Further, $dCylDp$ was used to evaluate the wall effect, but only $~10\%$ of the
all simulations had $dCylDp$ larger than $20$ (additional information can be found in \ref{subsec:srsctsimulation}). 
The normal stress $\sigma_n$ and its
percentage during the incipient flow condition $\tau_{\%}$
varied to replicate the twelve shear cell load conditions. 
In total, we realized $546$ shear cell and $81$ angle of repose simulations.
A Matlab script allowed us to extract from the simulations output the numerical
bulk representative values ($\mu_{psh}$, $\mu_{sh}$, $\rho_b$ and $AOR$) for each $simulation-DEM$ parameter combination. 
So, we could use the $DEM$ parameter combinations and their corresponding bulk values to train the $NN$. 
Notably, we excluded 15\% of the simulations ($test ~ simulations$), randomly
picked, from the training processes.
First, we started with all the $DEM$ parameter combinations and their corresponding numerical $\mu_{psh}$ to create 36 $NN$. 
They differed because they included from five to forty neurons in the hidden
layer.
Later, we controlled the square regression error between the $bulk-macro$ behaviours in the output of 
the $NN$ and the 15\% $test ~ simulations$, granted uncorrelated. 
So, we could select for $\mu_{psh}$ the $NN$ with the maximum $R^2$, and we noted its number of neurons. 
We repeated the same steps from the $NN$ creations for $\mu_{sh}$, $\rho_b$ and $AOR$, 
obtaining one trained $NN$ for each bulk representative value. \\
Notably, $\mu_{psh}$, $\mu_{sh}$ and $\rho_b$ belonged to the shear cell
simulations, so their $NN$ were handled together. 
We had one cluster with three $NN$ for the shear cell and one with only one $NN$
for the $AOR$.
Oberkampf et al. \cite{RefWorks:160} suggest to use a Design of Experiments
($DOE$) method to determine the parameters' combinations to be simulated.
They affirm that this approach allows optimizing the computational time with
only an acceptable loss of precision.
Thanks to the speed of the trained $NN$, we followed a different approach to
maximize the precision of the characterization.
We created random values
in the range and number defined in table \ref{tab:12DEMRandominputvalues}.
The total number of combinations of these random values was $6250000$. These
combinations were then processed by the selected $NN$, granting for each three bulk representative parameters for the shear cell and one for the $AOR$. Later, we confronted the $NN$ and experimental bulk behaviours for the twelve shear cell load conditions. 
If in a $DEM-parameter$ combination all the three bulk representative parameters differed less 
than 5\% from the corresponding experiments, see Eq. \ref{eq:check2}:
\input{equations/check2}
then the combination was marked. The marked combinations were handled by the
$AOR$ $NN$, and then confronted with the experiment.
Were branded as valid only those that differed less than $5\%$ also in this
comparison (Eq. \ref{eq:checkaor}):
\input{equations/checkaor}
Further, to prove the system validity, we tested the marked combinations by
modifying the experimental bulk behaviour representative values of the shear cell. 
We artificially decreased or increased $\mu_{psh}$ and $\mu_{sh}$ by a product
coefficient ($P$), e.g. Eq. \ref{eq:pcoeff}:
\input{equations/pcoeff}
\input{images/texCaller/19methodology}
\input{tables/09DEMFixedinputvalues}
\input{tables/10DEMVariableinputvalues}
\input{tables/12DEMRandominputvalues}