\chapter{Theory}
\label{sec:theory}

\epigraph{
	\textit{Hier sehen Sie die Kraft des reinen Denkens.} \\
	\hspace{1ex}\\
	\textit{Here you can see the power of pure reasoning.}
}{Prof. Hans Irschik}
		



% ---------------------------------
\subsubsection*{A note on \LaTeX{}}

At the beginning of each chapter you see some more or less smart quotes. This is often seen 
in more recent PhD theses, less often in Batchelor's and Master's theses. These quotes are 
produced with the \verb+epigraph+ package. This even works with images, such as XKCD comics 
(see Chapter \ref{app:derivation}), however, your advisor might not approve.



%% Section %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Eulerian two-phase modelling}

% continuum approach
In Eulerian two-phase modelling both phases are considered continua even though 
one phase might consist of dispersed phase elements (\acp{DPE}) such as bubbles, drops 
or particles. In such simulations the two phases can be divided into a 
continuous phase and a dispersed phase. This naming scheme refers to the physical 
situation. Within the (Eulerian) mathematical description, however, both phases 
are continua.


\begin{figure}[htbp]
  \null\hfill
  \subfloat[Discrete bubbles in a continuous liquid.]{
	  \input{images/EulerianFlowModelling/twoPhase_discreteBubbles_edit}
	  \label{subfig:twoPhaseSim_unresolved}
  }
  \hfill
  \subfloat[Continuum approach.]{
	  \input{images/EulerianFlowModelling/twoPhaseSim_continuum_fullRange_edit}
	  \label{subfig:twoPhaseSim_continuum}
  }
  \hfill\null
  \caption{Modelling approach on the example of a gas-liquid two-phase system.}
  \label{fig:twoPhaseSim_resolution}
\end{figure}




% ----------------------------------------------------------------------
\subsection{Governing equations}


% -----------------------------------------------
\subsubsection{Single-phase flow equations}
\label{sec:singlePhaseFlowEquations}

Since all multi-phase flow techniques are based on the solution of some set of flow equations, 
we repeat the governing equations for a continuous fluid. The derivation of this equations can 
be found in textbooks on fluid mechanics \cite{versteegMalalasekera1995,Anderson1995}.

\begin{gather}
	\frac{\partial \rho}{\partial t} + \nabla\mycdot\left( \rho \mathbf{u} \right) = 0 
		\label{eq:genericSinglePhaseContinuityTmp01} \\
	\frac{\partial \rho  \mathbf{u}}{\partial t}
		+ \nabla\mycdot\left( \rho \mathbf{u} \mathbf{u} \right)
		= -\nabla p + \nabla\mycdot\bm{\tau} \label{eq:genericSinglePhaseContinuityTmp02}
\end{gather}


\nomenclature[L]{$u$}{Velocity}%
\nomenclature[L]{$p$}{Pressure}%
\nomenclature[L]{$t$}{Time}%
\nomenclature[G]{$\rho$}{Density}%
\nomenclature[G]{$\tau$}{Shear stresses}%



% ---------------------------------
\subsubsection*{A note on \LaTeX{}}

In \cref{eq:genericSinglePhaseContinuityTmp01,eq:genericSinglePhaseContinuityTmp02} the bold letters 
are generated by writing \verb+\mathbf{u}+ and \verb+\bm{\tau}+. The reason for this are the 
following:

\begin{enumerate}
	\item I use \verb+\mathbf{}+ ever since out of habit
	\item With \verb+\mathbf{}+ greek letters can not be made bold
	\item The package \verb+bm+ provides the command \verb+bm{}+ for bold symbols
\end{enumerate}


We further see the command \verb+\mycdot+ in the source of Section \ref{sec:singlePhaseFlowEquations}. 
This is a user-defined command (see the file \verb+options.tex+.

\begin{align}
	&\text{using \textbackslash{}cdot} 		& \mathbf{a} \cdot \mathbf{b} &= \mathbf{c} \\
	&\text{using \textbackslash{}mycdot} 	& \mathbf{a} \mycdot \mathbf{b} &= \mathbf{c} \\
\end{align}

We see from comparing the output of \verb+\cdot+ and \verb+\mycdot+ or the definition of 
\verb+\mycdot+ in \verb+options.tex+ that \verb+\mycdot+ uses less space between the operands.




% -----------------------------------------------
\subsubsection{Conditional averaging}

% weller & conditional averaging
The theoretical basis for the two-phase model used in this work was laid by \citet{weller1993}. 
The derivation of the governing equations for Eulerian two-phase flow is covered in 
\cite{hill1998,rusche2002,openCFD2005}. \citet{weller1993} uses the so called 
\emph{conditional averaging} technique.

% what is conditional averaging
The govering equations are gained with the conditional averaging technique by multiplying 
the Navier-Stokes equations for both fluids with an indicator function $I_\varphi$, which is one 
for areas where the phase $\varphi$ is present and zero for where it is 
absent\footnote{As a physical location can not be occupied by two or more phases, the values 
of the indicator function $I_\varphi$ are strictly 0 and 1, i.e. $I_\varphi(\mathbf{x},t) \in \{0,1\}$.}. 
These conditioned equation are then averaged by applying a conventional averaging technique 
\cite{weller1993}.


\begin{gather}
	I_\varphi(\mathbf{x},t) = \begin{cases}
		1	& \text{if phase $\varphi$ is present at } (\mathbf{x},t) \\
		0	& \text{otherwise}
	\end{cases}
\end{gather}

The phase volume fraction $\alpha_\varphi$, which gives the probability for the phase $\varphi$ 
to be present at $(\mathbf{x},t)$, can be gained by applying the ensemble average of 
$I_\varphi(\mathbf{x},t)$ \cite{openCFD2005}.

\begin{gather}
	\alpha_\varphi = \overbar{I_\varphi}(\mathbf{x},t)
\end{gather}

The conditional average $\overbar{Q}_\varphi$ of an arbitrary quantity $Q$ is 

\begin{gather}
	\overbar{I_\varphi Q} = \alpha_\varphi \overbar{Q}_\varphi
\end{gather}

The derivation of the governing equations for multiphase flow with the conditional averaging 
technique can be found in \cite{marschallPhD,openCFD2005}.


\nomenclature[L]{$I$}{Averaging function}%
\nomenclature[G]{$\alpha$}{Volume fraction}%
\nomenclature[U]{$\varphi$}{Phase index of the phase $\varphi$}%
\nomenclature[O]{$\overbar{Q}$}{Averaged $Q$}%



% ---------------------------------
\subsubsection*{A note on \LaTeX{}}

Here we see the definition of a \emph{piecewise} function with the \verb+cases+ environment.


Note that in the source code there are curly braces following the underscore, thus 
\verb+I_\varphi(\mathbf{x},t)+ translates to $I_\varphi(\mathbf{x},t)$.


The symbol for averaging is the overbar. Note the difference between the \verb+\overbar{}+ 
and the \verb+\bar{}+. If you look closely, stumble upon it by chance or read this, you will 
notice that \verb+\overbar+ is actually a user-defined command with modified spacing.

\begin{align}
	&\text{using \textbackslash{}bar} & \bar{\alpha} &= \beta \\ % short symbol
	&\text{using \textbackslash{}bar} & \bar{\alpha \mathbf{u}} &= \beta \bar{\mathbf{u}} \\ % long symbol
	&\text{using \textbackslash{}overbar} & \overbar{\alpha} &= \beta \\ % short symbol
	&\text{using \textbackslash{}overbar} & \overbar{\alpha \mathbf{u}} &= \beta \overbar{\mathbf{u}} \\ % long symbol
\end{align}

There are also other symbols used to denote averaging, e.g. \verb+\widetilde{}+.

\begin{gather}
	\widetilde{a \mathbf{u}} = \widetilde{a} \widetilde{\mathbf{u}}
\end{gather}





% -----------------------------------------------
\subsubsection{Modelling Reynolds stresses}

% split into deviatoric and isotropic part
The Reynolds stress tensor can be split into an isotropic part and an anisotropic or 
deviatoric part \cite{pope2000}. \Cref{eq:tensorDeviatorDecomposition} shows the general definition.

\begin{gather}
	\mathbf{T} = \underbrace{\mathbf{T} - \frac{1}{3} \tr(\mathbf{T}) \,\mathbf{I}}_{\text{deviatoric part}}
		+ \underbrace{\frac{1}{3} \tr(\mathbf{T}) \,\mathbf{I}}_{\text{isotropic part}} 
		\label{eq:tensorDeviatorDecomposition}\\
	\mathbf{T} = \dev(\mathbf{T}) + \tr(\mathbf{T}) \mathbf{I}
\end{gather}


% ---------------------------------
\subsubsection*{A note on \LaTeX{}}

\verb+\underbrace{}_{}+ can be used to combine or subsume terms in equations.









% --------------------------------------
%\subsubsection{Quadrature method of moments  (\acs{QMOM})} % uncomment this, you might run into trouble
\subsubsection{Quadrature method of moments  (\NoCaseChange{\acs{QMOM}})}

% explain Q
The \ac{QMOM} proposed by \citet{mcGraw1997} alleviates the severe restriction of 
an equation not shown here \cite{mcGraw1997}. 

\begin{gather}
	M^{(k)} = \int_0^\infty V^k f(V) \dd V \approx \sum_{i=0}^n r_i^k w_i \label{eq:qmomAssumption}
\end{gather}


\nomenclature[U]{$i$}{Summation index}%
\nomenclature[S]{$M^{(k)}$}{$k$-th statistical moment of $M$}%


% ---------------------------------
\subsubsection*{A note on \LaTeX{}}

If you use the \verb+\acs{}+ commnad of the \verb+acronym+ in a heading, e.g. \verb+\subsubsection{}+, you 
have to enclose this with a \verb+\NoCaseChange{}+

The differential operator $\dd$ (an upright d) in the integral is a user-defined command \verb+\dd+. 
Mathematical operators need to be upright to be able to discern the variable $d$ from the operator $\dd$.





% --------------------------------------
\subsubsection{A little introduction to OpenFOAM}

% intro & a little history
OpenFOAM is an open source CFD framework based on its predecessor \ac{FOAM} \cite{weller1998}. By 
definition OpenFOAM is not strictly a CFD code. \citet{weller1998} originally describe \ac{FOAM} 
as a \emph{field operation and manipulation (\ac{FOAM}) C++ class library for continuum mechanics} 
and conclude:

\begin{myquote}
In essence, \ac{FOAM} is a high-level language, a \acs{CCM} meta-language, that closely parallels 
the mathematical description of continuum mechanics.
\end{myquote}


% ---------------------------------
\subsubsection*{A note on \LaTeX{}}

In the paragraph above, I used a user-defined environment \verb+myquote+. For comparison, 
the following is put into the standard \verb+quote+ environment.

\begin{quote}
In essence, \ac{FOAM} is a high-level language, a \acs{CCM} meta-language, that closely parallels 
the mathematical description of continuum mechanics.
\end{quote}





% --------------------------------------
\subsubsection{Flow equations in OpenFOAM}

Listing \ref{lst:pimpleFoamMomentumEq} shows the implementation of this equation in OpenFOAM and demonstrates the 
close resemblance of the top-level code of OpenFOAM to the standard mathematical notation.

\begin{lstlisting}[escapechar=ยง,style=cppStyle,caption={The momentum equation of the transient incompressible 
	solver \emph{pimpleFoam}.},label=lst:pimpleFoamMomentumEq] 
// momentum equation
tmp<fvVectorMatrix> UEqn
(
    fvm::ddt(U)
  + fvm::div(phi, U)
  + turbulence->divDevReff(U)
 ==
    fvOptions(U)
);
\end{lstlisting}

% ---------------------------------
\subsubsection*{A note on \LaTeX{}}

Above is an example of how to use the \verb+listings+ package





% --------------------------------------
\subsubsection{Nice tables with \texttt{bookstabs}}

Table \ref{tab:classicalLES_filters} is an example of

\begin{itemize}
	\item How to use \verb+booktabs+
	\item Make the table broader than its content requires it to be
	\item Manually tweak the alignment of some of the Table's content
	\item Use the \verb+cases+ environment of AMS-math
\end{itemize}


See \url{http://en.wikibooks.org/wiki/LaTeX/Tables} for information on tables in \LaTeX{}.


\begin{table}
	\centering
	\begin{tabular*}{0.8\textwidth}{ @{\extracolsep{\fill} } lll}
	\toprule
	Filter & \multicolumn{1}{c}{Physical space} & \multicolumn{1}{c}{Fourier space} \\
	\midrule
	Box 
		& $G_{\Delta}(x - \xi) = \begin{cases}
				\frac{1}{\Delta} & \text{ if } \vert x - \xi \vert < \frac{\Delta}{2} \\
				0 & \text{ otherwise}
			\end{cases}$ 
		& $\hat{G}(k) = \frac{\sin(k \frac{\Delta}{2})}{k \frac{\Delta}{2}}$ \\
	Gauss 
		& $G_{\Delta}(x - \xi) = \left( \frac{\gamma}{\pi \Delta^2} \right)^{\sfrac{1}{2}} 
			\exp\left( \frac{-\gamma \vert x - \xi \vert^2}{\Delta^2} \right)$
		& $\hat{G}(k) = \exp\left( \frac{-\Delta^2 k^2}{4 \gamma} \right)$ \\
	Fourier 
		& $G_{\Delta}(x - \xi) = \frac{\sin (k_c(x-\xi))}{k_c(x-\xi)}$
		& $\hat{G}(k) = \begin{cases}
				1 & \text{ if } \vert k \vert < k_c \\
				0 & \text{otherwise}
			\end{cases}$ \\
		& with $k_c = \frac{\pi}{\Delta}$ & \\
	\bottomrule
	\end{tabular*}
	\caption{The classical \ac{LES} filters}
	\label{tab:classicalLES_filters}
\end{table}




