% !TEX encoding = UTF-8
% !TEX TS-program = pdflatex
% !TEX root = ../Tesi.tex
% !TEX spellcheck = en-EN

%************************************************
\chapter{Numerical Simulation}
\label{cap:numericalsimulation}
%************************************************

\citet{RefWorks:172} define a \acs{DEM} numerical simulation as a computational
approximation of a real particulate material, represented as an ensemble of discrete, or distinct, elements, which
interact among each other according to defined contact laws.
Thus, under given hypotheses, we could use this simulation method to investigate
the nature and the behaviour of any granular medium.\\

\section{Software}
\label{sec:software}

We used the public open source \acs{DEM} software \acs{LIGGGHTS} as simulation toolbox.
\citet{RefWorks:136} and \citet{RefWorks:206} demonstrated its effectiveness.
Especially, it is an highly parallelized software, which allowed us to perform
our simulations on large scale clusters.\\
Performing a simulation with \acs{LIGGGHTS} consists of two steps:
\begin{enumerate}
  \item{write a script, stating the involved domain, the chosen contact laws,
  and the microscopic parameters of these laws;}
  \item{running the script in bash with single or multiple cores.}
\end{enumerate}

\section{Microscopic parameters}
\label{sec:microscopicparameters}

In our work, we decided to utilize a single
contact law for all the simulations performed (see \citet{RefWorks:205}).\\
Following the indications summarized in \ref{sec:timestep}, we chose time
steps between $1.29 \%$ and $1.53 \%$ of the Rayleigh time, 
depending on the particle density (\acs{rhop}) and on the particle size.
Furthermore, we kept constant the size distribution, which was obtained by
experimental sieving, see Table \ref{tab:09DEMFixedinputvalues}.\\
The \acs{DEM} values for the Young's modulus (\acs{E}) and the Poisson's
coefficient (\acs{nu}) were taken from the literature, see \cite{RefWorks:175} 
and \cite{RefWorks:176}; however we reduced the former to increase the time step
(\acs{deltat}), following the recommendations of Ai et al.
\cite{RefWorks:131}.\\

\section{Macroscopic parameters}
\label{sec:macroscopicparameters}

A Matlab script allowed us to extract from the simulation output the numerical
values representative of bulk behaviour (hereafter called \textit{bulk values}),
see Table \ref{tab:14bulkvalues},
for each \acs{DEM} simulation parameter combination.

\section{Drained Angle of Repose Simulation}
\label{sec:aorsim}

In \acs{AoR} simulations we sought to replicate meticulously the experimental
setup explained in Section \ref{sec:aor}, considering both the plate and the
liftable boundary, with the same domain size consideration as before see Fig. \ref{fig:065aorsim}. 
The particles had the same properties as in the shear-cell simulation. 
The first phase was identical to that of the shear-cell simulation. 
After lifting the boundary, the particles formed a heap.
An image post-processing software was used to obtain the average slope.
In the \acs{AoR} tests the average of the repose angles provided us with the fourth
bulk value of Table \ref{tab:14bulkvalues}.
\input{images/065aorsim}

\section{Shear Cell Simulation}
\label{sec:scsimulation}
%************************************************

\input{images/007shearcellsim}
\acs{LIGGGHTS}, the simulation toolbox we used, meets all the requirements of
modelling the shear tester described in \ref{sec:jsct}. 
First, it is capable of importing triangulated meshes of the two rings and a top lid. 
Since the real setup had a wall thickness, contact forces acting on a mesh are summed and can be saved, 
and thus shear force calculation is available out of the box. 
Second, the code can move a mesh with constant 
velocity as required for the measurement. 
To determine the shear stresses, the bulk solid had to be stressed with 
user-defined normal stresses. 
Therefore, a stress-controlled wall (servo-wall in \acs{LIGGGHTS}) was applied to the lid. \\
Although the geometry differs, the \acs{SCT} was designed to obtain the same values for the shear stresses as the 
Jenike shear cell tester (\acs{JSCT}), but with improved automation and reliability,
see Schulze \cite{RefWorks:118}. 
For this reason, the simulation setup was
based on the \acs{JSCT}, see Fig. \ref{fig:007shearcellsim}.
As suggested by Aigner et al. \cite{RefWorks:139} and Benvenuti et al. \cite{RefWorks:173}, 
the diameter and the height of the rings operated in the simulations had to be sufficiently large to avoid relevant wall effects. 
However, a larger domain increases the number of particles and thus
simulation time.
For this reason, we considered the cylinder dimension (\acs{dCylDp}), which is
proportional to the mean particle diameter, as an additional \acs{DEM}
parameter to be investigated.

\subsection{SCT simulation procedure}
\label{subsec:scsimulation}

A simulation run comprised four phases. 
First, the shear cell was filled with the granulate material, and it was allowed
to settle.
Then, the top lid was lowered and the first normal stress applied to the bulk
solid.
As in the experiment, the servo-wall allows calculating the position of the lid
while the first particle is being touched. 
The distance between the lid and the bottom of the domain multiplied by the 
simulation area gave the total volume.
Since the software already provided the total mass, we were able to calculate
the bulk density (\acs{rhob}).\\
Next, the ring moved by a distance $l=0.1875 \cdot radius ~of ~the ~ring$, and
the required pre-shear force was measured.
Finally, the normal load was reduced to a fraction of the initial load, 
the ring was moved again by a distance $l$, and the shear force was recorded. 
Unlike in the original experiment, the bottom ring was moved to facilitate the numerical simulation. 
The velocity of the ring displacement, and consequently the total simulation time, 
was determined by a trade-off between minimizing the normal load oscillation and
optimizing computation time. 
The former requires (relatively) low velocity, and the latter requires high
speed.
We chose a constant velocity of $3*(mean ~ particle ~ radius)/seconds$, as the
best trade-off.\\
The normal stresses (pre-shear and shear phases) applied in each simulation were
the same as in the experiments.
The corresponding $\tau_{psh}$ and $\tau_{sh}$ were calculated - as in the experiments - from the mean of the plateau.\\

\subsection{SCT Simulation Input Parameters}
\label{subsec:sctsimulationinputparameters}

The input \acs{DEM} coefficients, \acs{CoR}, \acs{mus}, \acs{mur},
\acs{rhop} and \acs{dCylDp} (the cylinder dimension, proportional to the mean
particle diameter), as indicated in Table \ref{tab:10DEMVariableinputvalues}, 
were constant in each simulation, but their combination differed between
simulations.
Further, \acs{dCylDp} was used to evaluate the wall effect, but only $~10\%$ of the
simulations had a \acs{dCylDp} larger than $20$.
The normal stress \acs{sigman} and its
percentage during the incipient flow condition \acs{tauperc}
varied to replicate twelve shear-cell load conditions.\\ 

\subsection{SCT Simulation Output Parameters}
\label{subsec:sctsimulationoutputparameters}

\input{images/021simexample}
Each \acs{SCT} simulation gave three of the \texit{bulk values} indicated in
Table \ref{tab:14bulkvalues}.
The first bulk value (\acs{rhob}) was provided directly. 
For correctly performed simulations, we
observed a stress path as the example in Fig. \ref{fig:021simexample}.
Time was normalized: $\tilde{t} = t/t_{change}$, where $t_{change}$ is the
point in time at which the normal stress (\acs{sigman}) was modified during the
tests.
Until $\tilde{t}=1$, the \acs{sigman} was kept constant at 10,000 Pa.
In Fig. \ref{fig:020experimental},
a plateau was reached at $\tilde{t}~=0.91$.
The coefficient of pre-shear (\acs{mupsh}) was calculated as the average of the
coefficient of internal friction (\acs{muie}) in this first plateau.
At $\tilde{t}=1$, the \acs{sigman} was reduced to $80 \%$ of its initial
value, and soon after
a second plateau developed.
We obtained the coefficient of
shear (\acs{mush}) as the average of \acs{muie} in this second plateau.
The stress paths between Fig. \ref{fig:007shearcellsim} and Fig.
\ref{fig:020experimental} agree well, especially the plateaux.
They were clearly relevant because
the values representative of the bulk behaviours were collected there.\\
Together with the value from the \acs{AoR} simulation, we were able to define
the numerical bulk behaviour.\\
All the results in this chapter are pure \acs{DEM}, so they shoould be
materials agnostic, given the same particle distribution, see
Section \ref{sec:polydispersity}.


%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-
%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-%*-*-*-*-*-

\section{Influence of variations of input parameters}
\label{sec:influence}

In total, 2,400 shear cell and 400 static \acs{AoR} simulations 
were run with
the parameter combinations described in Table
\ref{tab:10DEMVariableinputvalues} with different particle size
distributions for the various materials analyzed.
The computational time amounted to 1 hour with 32 AMD cores for a benchmark
shear-cell simulation and to 9 hours for a benchmark \acs{AoR} simulation, both with
50,000 particles.
Simulations with larger \acs{dCylDp} required more time (e.g., about 12 hours for
the shear cell with 400,000 particles ). \\
To better understand the effect of the variation of the input parameters, nine
\acs{SCT} simulations have been selected, and their stress paths shown in Fig.
\ref{fig:136comparisonfrictioncoefficients}.

\input{images/136comparisonfrictioncoefficients}

\input{tables/10DEMVariableinputvalues}.

\info{Some examples on how the numerical bulk values change when the DEM input
values change.}
